# SPDX-FileCopyrightText: Â© 2023 CoreWeave, Inc. <sunk@coreweave.com>

minimum_pre_commit_version: "3.5.0"
default_install_hook_types: [commit-msg, pre-commit]
default_language_version:
  node: 20.16.0 # markdownlint-cli2 & commitlint require nodejs >= 18.
repos:
  - repo: https://github.com/alessandrojcm/commitlint-pre-commit-hook
    rev: v9.22.0
    hooks:
      - id: commitlint
        stages: [commit-msg]
        additional_dependencies: ["@commitlint/config-conventional"]
  - repo: https://github.com/pre-commit/pre-commit-hooks
    rev: v5.0.0
    hooks:
      - id: trailing-whitespace
        stages: ["pre-commit"]
      - id: check-yaml
        stages: ["pre-commit"]
        args: [--allow-multiple-documents]
        exclude: ^(charts/.*/templates|mkdocs.yaml) # Helm templates and MkDocs config fails yaml checks
      - id: check-case-conflict
        stages: ["pre-commit"]
      - id: check-executables-have-shebangs
        stages: ["pre-commit"]
      - id: check-shebang-scripts-are-executable
        stages: ["pre-commit"]
      - id: no-commit-to-branch
        args: [--branch, "develop"] # To prevent committing changes locally to develop
  - repo: https://github.com/DavidAnson/markdownlint-cli2
    rev: v0.17.2
    hooks:
      - id: markdownlint-cli2
  - repo: https://github.com/rhysd/actionlint
    rev: v1.7.7
    hooks:
      - id: actionlint
        additional_dependencies:
          # hook does not install shellcheck by default and if not present skips these checks
          # using go-shellcheck as it is easier to install and is a wrapper around shellcheck
          - "github.com/wasilibs/go-shellcheck/cmd/shellcheck@latest"
        language_version: 1.23.4
